import{c as f}from"./ccount.1cb94a01.js";import{u as k,a as p}from"./micromark-util-character.2c47e118.js";import{f as g}from"./mdast-util-find-and-replace.7ab5ba95.js";const o="phrasing",s=["autolink","link","image","label"],z={transforms:[L],enter:{literalAutolink:d,literalAutolinkEmail:u,literalAutolinkHttp:u,literalAutolinkWww:u},exit:{literalAutolink:m,literalAutolinkEmail:A,literalAutolinkHttp:w,literalAutolinkWww:x}},H={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:o,notInConstruct:s},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:o,notInConstruct:s},{character:":",before:"[ps]",after:"\\/",inConstruct:o,notInConstruct:s}]};function d(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function u(t){this.config.enter.autolinkProtocol.call(this,t)}function w(t){this.config.exit.autolinkProtocol.call(this,t)}function x(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.url="http://"+this.sliceSerialize(t)}function A(t){this.config.exit.autolinkEmail.call(this,t)}function m(t){this.exit(t)}function L(t){g(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,y],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,E]],{ignore:["link","linkReference"]})}function y(t,e,i,l,r){let n="";if(!h(r)||(/^w/i.test(e)&&(i=e+i,e="",n="http://"),!P(i)))return!1;const a=W(i+l);if(!a[0])return!1;const c={type:"link",title:null,url:n+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[c,{type:"text",value:a[1]}]:c}function E(t,e,i,l){return!h(l,!0)||/[_-\d]$/.test(i)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+i,children:[{type:"text",value:e+"@"+i}]}}function P(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function W(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);let i,l,r,n;if(e)for(t=t.slice(0,e.index),n=e[0],i=n.indexOf(")"),l=f(t,"("),r=f(t,")");i!==-1&&l>r;)t+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),r++;return[t,n]}function h(t,e){const i=t.input.charCodeAt(t.index-1);return(t.index===0||k(i)||p(i))&&(!e||i!==47)}export{H as a,z as g};
